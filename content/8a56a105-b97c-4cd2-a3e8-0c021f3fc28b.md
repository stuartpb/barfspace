# grarg

https://github.com/stuartpb/grarg

Extension plans:

- Passing the parameters to the callback as a third argument, allowing for tricks like `end:0` to be set.
- A mutable state to pass to the callback as a fourth argument, that will be used as the return value for the function.
  - This will also allow the callback to be optional, defaulting to a function that collects pairs as a two-dimensional array, ie. for use passing to `new Map`.

## Thoughts on params.short

I'm glad I didn't make this a default like I'd been planning.

Short opts are really a special-case of parsing, and you might as well have special support for them in valid positions anyway.

## A better way

This should be implemented as an Express-style "use filter" parser.

Callbacks can return an array (or a Thenable that resolves with an array) to process args:

- Returning `[]` will remove the pair from the stream.
- Returning `[[a,b]]` will pass the pair along unchanged.
- Returning `[[a,null],[null,b]]` will split the param into two options.
- Returning nothing is only allowed if you're the last consumer.

Also, this'd let `short` and `end` be insertable filters.

Also, to avoid invoking Zalgo, there should be sync/async variants that disallow and enforce Promises, respectively. (I'm thinking the async can be avariant and the core can be )

`end` would need some way to signal "stop parsing equals as a splitter", which suggests that should be a separate option as well?

## The underlying primitive

A function that takes an array and an array of functions, then, for each item in the input array, calls each function in the filter array, calling the next items in the

It's a series of frames for a state. Is `zoetrope` taken? What about `bowler`? Or `crank` (because it's like how you an insert or remove frames by over/undercranking)?

Engine? Intestine? (Bowel / boweler?)

Taken:

- bowl
- alley
